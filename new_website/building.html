<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
   
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <title>Aria Maestosa</title>
    <link rel="stylesheet" href="style.css"/>
    <script src="section_code.js" type="text/javascript"> </script>

</head>

<body style="margin: 0px; padding: 0px;">

<script src="menu.js" type="text/javascript"> </script> 

<!--   ************  GETTING SETUP  *************  -->

<blockquote>

<p>
    First, download the source code from the <a href="http://sourceforge.net/project/showfiles.php?group_id=186987">sourceforge
    downloads area</a> or from SVN.<br/>
    Aria is written in C++.<br/>
</p>

<p>
    <b>Dependencies : </b>
</p>
<ul>
    <li> GCC (g++). Included in the developer tools on OS X, found in repositories of all distros on Linux, MinGW on Windows (VisualStudio not supported).</li>
    <li> <a href="http://www.wxwidgets.org">wxWidgets</a>. I am currently using 2.8.x on Linux/Windows, and 2.9.x trunk on OS X (because trunk has a couple printing bugs fixed)</li>
    <li> <a href="http://www.opengl.org">OpenGL</a> if you use the OpenGL renderer, which is optional (OpenGL is included by default on mac OS X)</li>
    <li> <a href="http://www.jdkoftinoff.com/main/Free_Projects/C++_MIDI_Library/"> libjdkmidi</a> (included in the Aria source)</li>
    <li> <a href="http://www.ambiera.com/irrxml/index.html">irrXML</a> (included in the Aria source)</li>
    <li> On Linux/Unix systems, you need Alsa or Jack (experimental Jack support is available starting from 1.2.3).
          [On OSX/Windows, the native MIDI librairies are used so nothing needs to be installed there]</li>
</ul>

<p>
    <b>Build system : </b>
</p>

<ul>
    <li> <a href="http://www.scons.org/">scons</a> (included in the Aria source tree so you don't need to get it separately)</li>
    <li> Under the OSX subdirectory, a Xcode project is available; not that you will need to run <tt>./configure.sh</tt> first in the same directory to generate
    the appropriate files (note that the scons build system does work on OSX so you do not <i>need</i> to use Xcode if you're on mac)</li>
    <li> You can also build with your favorite IDE/build system, but you'll then need to set up things yourself.</li>
</ul>

<p>
    <br/><br/>
</p>

<h2>Prerequisites</h2>


<script type="text/javascript">
    writeSectionTop('osx', 'Prerequisites - Mac OS X', ['osx.png']);
</script>


<p>
    You will need to install Developer Tools from the mac OS X install disc. You need OS X 10.4.
</p>

<p>
    <b>Installing wxWidgets :</b> First, download and install wxWidgets. I usually build static. Don't forget to enable
    OpenGL support if you use wxWidgets 2.8. 
</p>

<p>
    Starting from Aria 1.2, I use wxOSX 2.9.x trunk. wxWidgets 2.8 will still work but it has a couple printing-related bugs.
    Because wx 2.9 still has a couple bugs, patches have been included in the /OSX directory - apply them to wxWidgets before
    building it for better results.
</p>

<p>
    Example terminal commands to build wx (read the instructions that come with wxWidgets or wxWiki for more info):
    
    <br/><br/>
    <span class="code">
    cd wxMac2.x.x
    mkdir osx-build &amp;&amp; cd osx-build
    ../configure --with-libjpeg=builtin --with-libpng=builtin --with-regex=builtin --without-libtiff
         --with-zlib=builtin --with-expat=builtin --with-opengl --enable-unicode --disable-shared
    make
    sudo make install
    </span>
    
</p>

<p>
    OR, to build wxOSX/Cocoa (wxWidgets 2.9.2+ only) :
</p>

<p>
    <span class="code">
    ../configure --with-cocoa --with-libjpeg=builtin --with-libpng=builtin --with-regex=builtin
        --without-libtiff --with-zlib=builtin --with-expat=builtin --disable-shared
        --enable-macosx_arch=i386 --with-macosx-version-min=10.5
        --with-macosx-sdk=/Developer/SDKs/MacOSX10.5.sdk
    </span>
</p>

<p>
    Make sure <i>wx-config --libs</i> points to the 2.8 libs when run from a terminal. Mac OS X 10.4 comes with wxWidgets 2.5 pre-installed. It
    is <b>not</b> recommended to build Aria with it. If you install wxWidgets 2.8 from source, it will default to installing in /usr/local,
    however pre-installed 2.5 is in /usr, so be careful about conflicts. If /usr comes before /usr/local in yout PATH environment variable, you 
    will get the 2.5 libs. For getting 2.5 out of the way quickly, just get /usr/bin/wx-config out of the way
    (sudo mv /usr/bin/wx-config /usr/bin/wx-config-2.5). If your computer does not find wx-config, make sure /usr/local/bin is in your PATH
    (or pass WXCONFIG=/usr/local/bin/wx-config to scons - see explainations below).
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<div>
    <br/>
</div>

<script type="text/javascript">
    writeSectionTop('linux', 'Prerequisites - Linux', ['linux.png']);
</script>

<p>
    <b>Warning</b> : Midi on Linux is especially painful, synthesizers like TiMidity haven't been maintained for years, eat a lot of CPU
    and don't play nicely with PulseAudio. In the future I will consider alternative implementations.<br/>
    <br/>You will need Python, Alsa (including -dev packages if your distro uses them), wxGTK (wxWidgets), OpenGL (if you wish to use the OpenGL
    renderer, and also get -dev packages if any), gcc/g++ (build-essential in Ubuntu). For midi playback, you will need a softsynth like Timidity
    with a soundbank (more info below)
</p>
<p>
    <b>Installing wxWidgets : </b> You can simply download wxWidgets 2.8 from your distribution's repositories. It needs OpenGL support enabled if
    you want to use the OpenGL renderer, and should be Unicode. Don't forget to install -dev packages if your distribution uses them.
    <br/><br/>If you want to build wxWidgets from source, you can use commands like (read the instructions that come with wxWidgets or wxWiki for
    more info):<br/><br/>
    <span class="code">
    cd wxGTK2.8.x
    mkdir gtk-build &amp;&amp; cd gtk-build
    ../configure --with-opengl --enable-unicode
    make
    sudo make install
    </span>
</p>

<p>
    Make sure <i>wx-config --libs</i> points to the 2.8 libs when run from a terminal. If it does not, it is likely that your distribution's wxWidgets
    (in /usr/) is picked up before the one you built (in /usr/local/). To fix this, you can pass WXCONFIG=/usr/local/bin/wx-config to scons when
    building - more info below.
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<div>
    <br/>
</div>

<script type="text/javascript">
    writeSectionTop('windows', 'Prerequisites - Windows', ['windows.png']);
</script>

<p>
    Install MinGW. You'll need Python if you wish to use the scons build system (and update your PATH env variable if you wish to
    invoke python from the terminal without using the full path).
</p>

<p>
    <b>Installing wxWidgets : </b> Build using MinGW. You can use a command like :
</p>

<p>
    <span class="code">
    cd "C:\wxWidgets-2.8.10\build\msw"
    mingw32-make -f makefile.gcc UNICODE=1 SHARED=0 MONOLITHIC=0 BUILD=release
    </span>
</p>

<p>
    Check the wxWidgets READMEs or the wxWiki for more information.
    You will also need to install the Windows version of wx-config (a binary is included in CodeLite packages so you can rip it
    from there).
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<p>
    <br/><br/>
</p>
<!--   ************  COMPILING  *************  -->

<h2>Compiling</h2>

<script type="text/javascript">
    writeSectionTop('osx linux', 'Compiling Aria (OS X / Linux)', ['osx.png', 'linux.png']);
</script>

<p>
    You are now ready to build Aria itself. All you need to do is type the scons command :
</p>

<p>
    <span class="code">
    python scons/scons.py
    </span>
</p>

<p>
    This will do a release build with default wxWidgets. Issue <i>python scons/scons.py --help</i> for a summary of all possible options,
    like to get a debug build or to use a different wxWidgets build.
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<div>
    <br/>
</div>

<script type="text/javascript">
    writeSectionTop('windows', 'Compiling Aria (Windows)', ['windows.png']);
</script>

<p>
    The command may need to be adapted a little, depending on your enviroment. Here are a few examples :
</p>

<p>
    <span class="code">
    python.exe scons/scons.py WXCONFIG="C:\wx-config --debug=no --static=yes
        --prefix=C:\wxWidgets-2.8.10" renderer="wxwidgets" WX_HOME="C:\wxWidgets-2.8.10\"
    
    python.exe scons/scons.py WXCONFIG="C:\wx-config  --prefix=C:\wxWidgets-2.9.1
        --wxcfg=gcc_dll\mswud" renderer="wxwidgets" WX_HOME="C:\wxWidgets-2.9.1\"
    </span>
</p>

<p>
    Adapt the path to "wx-config" and to your wxWidgets build as needed. Modify the flags given to wx-config to get the right
    build if you have many wxWidgets builds.
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<p>
    <br/><br/>
</p>

<!--   ************  FINISHING  *************  -->

<h2>Finishing</h2>

<script type="text/javascript">
    writeSectionTop('osx', 'Finishing on OS X', ['osx.png']);
</script>

<p>
    You can make a mac OS X app bundle with the following command:
    <br/><br/>
    
    <span class="code">
    python scons/scons.py install
    </span>
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<div>
    <br/>
</div>

<script type="text/javascript">
    writeSectionTop('linux', 'Finishing on Linux', ['linux.png']);
</script>

<p>
    <b>Getting a MIDI synthesizer</b>
</p>

<p>
    If it is not already the case, you will need to install a softsynth like Timidity configured with flags :
    
    <br/><br/>
    <span class="code">
    ./configure --enable-audio=alsa --enable-server --enable-alsaseq
    </span>
    <br/><br/>
    
    And you also need a soundbank (many distros will ship FreePats in their repos).
    And finally run the synth as an Alsa daemon with commands (in the case of Timidity) :
    
    <br/><br/>
    <span class="code">
    timidity -iA -Os -EFreverb=0
    </span>
    <br/><br/>
    
    <tt>-EFreverb=0</tt> disables reverbering because it tends to cause problems, but you can leave that
    part out if you computer is very fast.
    <br/>
    
    Unfortunately, if you use PulseAudio, there are known compatibility issues with the timidity daemon.
    In particular, running the Timidity daemon at startup as part of init.d seems to cause a lot of issues.
    <br/><br/>
    Newer versions of Aria have an item in the preferences that, if enabled, will make Aria automatically
    launch TiMidity and pick a port. This should make the process a little more enjoyable, even though
    audio on Linux still seems to remain very difficult to handle =( So I'm afraid getting Aria to run on
    Linux can be a little pain because of the Linux audio maze. Sorry, I'll try to support other midi
    synths than TiMidity/Alsa in the future.
    <br/><br/>
</p>

<p>
    <b>Running in-place</b>
</p>

<p>
    At this point, if you are happy with letting Aria live in this folder, you can simply run it with
    <tt>./Aria</tt>
    <br/><br/>
</p>

<p>
    <b>Installing</b>
</p>

<p>
    You can also install Aria into /usr/local/ by running the following command as root :

    <br/><br/>
    <span class="code">
    python scons/scons.py install
    </span>
    <br/><br/>

    Or, to specify an install prefix :

    <br/><br/>
    <span class="code">
    python scons/scons.py install prefix=/usr/
    </span>
    <br/><br/>
    
    You can uninstall it later if you want with
    
    <br/><br/>
    <span class="code">
    python scons/scons.py uninstall prefix=/usr
    </span>
    <br/><br/>
    
    Don't forget to specify the prefix it was installed into if it is not the default one.
    <br/><br/>

    Then, to open Aria, type <tt>Aria</tt> in a terminal. Hopefully all will be fine!
    <br/><br/>
</p>

<p>
    <b>Register Aria using Freedesktop standards</b>
</p>

<p>
    On a further note, you may also run script <tt>installMimeType.sh</tt> found under the
    <tt>/Freedesktop</tt> directory to register Aria Maestosa files associations using the freedesktop
    standard. This script will also install the <tt>.desktop</tt> file for Aria in <tt>/usr/share/</tt>
    (this path is not configurable currently, sorry, edit the file if you want to install it somewhere else)
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<div>
    <br/>
</div>


<script type="text/javascript">
    writeSectionTop('windows', 'Finishing on Windows', ['windows.png']);
</script>

<p>
    If your wxWidgets build is a DLL build, copy the DLL(s) into the same directory as Aria so they are
    found.
</p>

<script type="text/javascript">
    writeSectionBottom();
</script>

<p>
    <br/>
</p>

<!--   ************  DONE  *************  -->
<h2>Closing Words</h2>

<p>
    If you have any question or issue, do not hesitate to contact me!
    <br/>
</p>

</blockquote>

<script src="menu_bottom.js" type="text/javascript"> </script> 

</body>

</html>